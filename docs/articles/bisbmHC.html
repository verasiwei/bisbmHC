<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>bisbmHC ‚Ä¢ bisbmHC</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="bisbmHC">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bisbmHC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bisbmHC.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="bisbmHC_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="bisbmHC_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="bisbmHC_files/r2d3-render-0.1.0/r2d3-render.js"></script><script src="bisbmHC_files/webcomponents-2.0.0/webcomponents.js"></script><script src="bisbmHC_files/r2d3-binding-0.2.4/r2d3.js"></script><script src="bisbmHC_files/d3v5-5.9.2/d3.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>bisbmHC</h1>
                        <h4 class="author">Siwei Zhang</h4>
            
            <h4 class="date">1/20/2021</h4>
      
      
      <div class="hidden name"><code>bisbmHC.Rmd</code></div>

    </div>

    
    
<div id="set-up" class="section level2">
<h2 class="hasAnchor">
<a href="#set-up" class="anchor"></a>Set up</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>packages &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"sbmr"</span>,<span class="st">"glue"</span>,<span class="st">"tidyverse"</span>,<span class="st">"purrr"</span>,<span class="st">"Rcpp"</span>,</span>
<span id="cb1-2"><a href="#cb1-2"></a>              <span class="st">"igraph"</span>,<span class="st">"ggplot2"</span>,<span class="st">"gridExtra"</span>,<span class="st">"RSpectra"</span>,</span>
<span id="cb1-3"><a href="#cb1-3"></a>              <span class="st">"pheSBMR"</span>,<span class="st">"future"</span>,<span class="st">"foreach"</span>,<span class="st">"doParallel"</span>,</span>
<span id="cb1-4"><a href="#cb1-4"></a>              <span class="st">"devtools"</span>,<span class="st">"Matrix"</span>,<span class="st">"expm"</span>,<span class="st">"cluster"</span>,<span class="st">"readxl"</span>,</span>
<span id="cb1-5"><a href="#cb1-5"></a>              <span class="st">"phewasHelper"</span>,<span class="st">"r2d3"</span>,<span class="st">"dplyr"</span>,</span>
<span id="cb1-6"><a href="#cb1-6"></a>              <span class="st">"R.utils"</span>,<span class="st">"aws.s3"</span>,<span class="st">"poweRlaw"</span>,<span class="st">"stringi"</span>,<span class="st">"d3r"</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(packages, library, <span class="dt">character.only =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a>devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/load_all.html">load_all</a></span>(<span class="st">"/home/siwei/bisbmHC"</span>)</span></code></pre></div>
</div>
<div id="input-data" class="section level2">
<h2 class="hasAnchor">
<a href="#input-data" class="anchor"></a>Input data</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"phenome_dat_long"</span>,<span class="dt">package =</span> <span class="st">"bisbmHC"</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(phenome_dat_long)</span></code></pre></div>
<pre><code>##   id phecode
## 1 R1  008.00
## 2 R2  008.52
## 3 R3  008.52
## 4 R4  008.52
## 5 R5  008.52
## 6 R6  038.00</code></pre>
</div>
<div id="run-bisbm-parallelly-in-docker" class="section level2">
<h2 class="hasAnchor">
<a href="#run-bisbm-parallelly-in-docker" class="anchor"></a>Run biSBM parallelly in Docker</h2>
<p>The biSBM algorithm is basically graph-tool based and credit to <a href="https://github.com/tbilab/pheSBMR">pheSBMR</a> package.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>bisbmresults &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_bisbm.html">run_bisbm</a></span>(<span class="dv">10</span>,<span class="dv">10</span>,phenome_dat_long)</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>bisbmresults[[<span class="dv">1</span>]] <span class="op">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>()</span></code></pre></div>
</div>
<div id="build-the-consensus-graph" class="section level2">
<h2 class="hasAnchor">
<a href="#build-the-consensus-graph" class="anchor"></a>Build the Consensus Graph</h2>
<p>Tracking the fraction of times two nodes are connected from iteratively cluster using biSBM and built a consensus graph according to patient-diagnosis code relationship. Iteratively implement biSBM on the input patient-diagnosis matrix and extract the generated adjacency matrix on patients with the element equal to 1 if two patients are grouped into the same community and 0 otherwise from the estimation through biSBM <span class="math inline">\(A^1\)</span>, <span class="math inline">\(A^2\)</span>, .., <span class="math inline">\(A^ùëÄ\)</span> and then compute consensus graph <span class="math inline">\(P=\sum^{M}_{m=1} \frac{A^m}{M}\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># works on patients groups</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"bisbmresults"</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a>id_label &lt;-<span class="st"> </span>bisbmresults[[<span class="dv">1</span>]] <span class="op">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(type<span class="op">==</span><span class="st">"id"</span>) <span class="op">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(level<span class="op">==</span><span class="dv">0</span>) <span class="op">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(node) <span class="op">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="st">  </span><span class="kw">arrange</span>(node)</span>
<span id="cb5-8"><a href="#cb5-8"></a>id_label &lt;-<span class="st"> </span>id_label<span class="op">$</span>node</span>
<span id="cb5-9"><a href="#cb5-9"></a></span>
<span id="cb5-10"><a href="#cb5-10"></a>consensus_dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/consensus_build.html">consensus_build</a></span>(id_label,<span class="st">"id"</span>,bisbmresults,<span class="dt">parallel=</span><span class="ot">TRUE</span>,<span class="dt">workers=</span><span class="dv">10</span>)</span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(consensus_dat)</span></code></pre></div>
<pre><code>##   from   to weight
## 1   R1   R1    1.0
## 2   R1  R10    0.0
## 3   R1 R100    0.0
## 4   R1 R101    0.0
## 5   R1 R102    0.6
## 6   R1 R103    0.3</code></pre>
</div>
<div id="recursive-partitioning" class="section level2">
<h2 class="hasAnchor">
<a href="#recursive-partitioning" class="anchor"></a>Recursive Partitioning</h2>
<p>One of the benefits of this algorithm is that we don‚Äôt need to specify the number of clusters in prior. It will be helpful in the unsupervised clustering since we do not have enough information to estimate the number of clusters at first. Recursive partitioning starts with the whole network and partition the nodes into two communities until a stopping rule agrees with no further communities. Here we use the non-backtracking stopping rule and users can define the partition method like kmeans and so on.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>g &lt;-<span class="st"> </span><span class="kw">graph_from_data_frame</span>(consensus_dat,<span class="dt">directed =</span> F,<span class="dt">vertices =</span> <span class="ot">NULL</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>g &lt;-<span class="st"> </span><span class="kw">simplify</span>(g)</span>
<span id="cb7-3"><a href="#cb7-3"></a>adj &lt;-<span class="st"> </span><span class="kw">get.adjacency</span>(g,<span class="dt">type =</span> <span class="st">"both"</span>,<span class="dt">attr =</span> <span class="st">"weight"</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#get the cluster results including the path of each node</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>cluster.result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/recursive_biTree.html">recursive_biTree</a></span>(adj,<span class="dt">cluster.labels.list=</span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(),</span>
<span id="cb7-7"><a href="#cb7-7"></a>                                   <span class="dt">ncluster=</span><span class="dv">0</span>, <span class="dt">cluster.labels=</span>id_label,</span>
<span id="cb7-8"><a href="#cb7-8"></a>                                   <span class="dt">n.min=</span><span class="dv">10</span>,<span class="dt">method=</span><span class="st">"kmeans"</span>)</span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a>cluster.result[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## [[1]]
##   [1] "R100" "R101" "R122" "R124" "R125" "R146" "R149" "R151" "R152" "R155"
##  [11] "R156" "R157" "R158" "R166" "R167" "R172" "R177" "R179" "R180" "R182"
##  [21] "R183" "R186" "R188" "R190" "R193" "R195" "R196" "R199" "R200" "R201"
##  [31] "R202" "R203" "R204" "R205" "R206" "R210" "R211" "R212" "R214" "R215"
##  [41] "R218" "R219" "R220" "R222" "R223" "R224" "R225" "R227" "R228" "R230"
##  [51] "R231" "R235" "R237" "R238" "R239" "R240" "R242" "R243" "R244" "R245"
##  [61] "R246" "R248" "R249" "R250" "R251" "R253" "R254" "R255" "R256" "R259"
##  [71] "R260" "R262" "R263" "R264" "R266" "R267" "R268" "R269" "R273" "R274"
##  [81] "R278" "R280" "R282" "R284" "R286" "R287" "R288" "R289" "R290" "R291"
##  [91] "R292" "R346" "R347" "R348" "R349" "R368" "R378" "R45"  "R58"  "R89" 
## [101] "R90" 
## 
## [[2]]
##  [1] "R11"  "R123" "R133" "R148" "R150" "R174" "R184" "R189" "R19"  "R191"
## [11] "R192" "R197" "R198" "R207" "R208" "R209" "R229" "R252" "R265" "R275"
## [21] "R276" "R279" "R283" "R301" "R302" "R308" "R328" "R329" "R338" "R342"
## [31] "R362" "R365" "R367" "R39"  "R4"   "R40"  "R42"  "R48"  "R68"  "R82" 
## [41] "R9"  
## 
## [[3]]
##  [1] "R10"  "R161" "R164" "R21"  "R217" "R226" "R257" "R258" "R270" "R28" 
## [11] "R30"  "R32"  "R37"  "R66" 
## 
## [[4]]
##  [1] "R118" "R12"  "R129" "R130" "R135" "R14"  "R15"  "R153" "R16"  "R18" 
## [11] "R20"  "R22"  "R23"  "R24"  "R27"  "R277" "R281" "R29"  "R293" "R298"
## [21] "R3"   "R303" "R306" "R309" "R31"  "R311" "R312" "R314" "R315" "R317"
## [31] "R321" "R324" "R326" "R327" "R33"  "R330" "R332" "R335" "R35"  "R364"
## [41] "R38"  "R51"  "R54"  "R6"   "R62"  "R71"  "R75"  "R79"  "R8"   "R97" 
## 
## [[5]]
##  [1] "R17"  "R181" "R187" "R2"   "R213" "R25"  "R26"  "R34"  "R345" "R369"
## [11] "R44"  "R47"  "R50"  "R7"  
## 
## [[6]]
##  [1] "R13"  "R131" "R132" "R136" "R142" "R144" "R46"  "R77"  "R78"  "R81" 
## [11] "R86"  "R91"  "R92"  "R93"  "R94"  "R95"  "R99" 
## 
## [[7]]
##  [1] "R138" "R139" "R140" "R221" "R241" "R271" "R272" "R299" "R319" "R322"
## [11] "R323" "R350" "R41"  "R5"   "R80" 
## 
## [[8]]
##  [1] "R103" "R115" "R126" "R127" "R128" "R134" "R137" "R295" "R300" "R304"
## [11] "R305" "R307" "R310" "R331" "R336" "R340" "R36"  "R361" "R366" "R43" 
## [21] "R53"  "R61"  "R63"  "R65"  "R69"  "R73"  "R76"  "R85"  "R96" 
## 
## [[9]]
##  [1] "R1"   "R102" "R104" "R105" "R106" "R107" "R108" "R109" "R110" "R111"
## [11] "R112" "R113" "R114" "R116" "R117" "R119" "R120" "R121" "R141" "R143"
## [21] "R145" "R147" "R154" "R159" "R160" "R162" "R163" "R165" "R168" "R169"
## [31] "R170" "R171" "R173" "R175" "R176" "R178" "R185" "R194" "R216" "R232"
## [41] "R233" "R234" "R236" "R247" "R261" "R285" "R294" "R296" "R297" "R313"
## [51] "R316" "R318" "R320" "R325" "R333" "R334" "R337" "R339" "R341" "R343"
## [61] "R344" "R351" "R352" "R353" "R354" "R355" "R356" "R357" "R358" "R359"
## [71] "R360" "R363" "R370" "R371" "R372" "R373" "R374" "R375" "R376" "R377"
## [81] "R49"  "R52"  "R55"  "R56"  "R57"  "R59"  "R60"  "R64"  "R67"  "R70" 
## [91] "R72"  "R74"  "R83"  "R84"  "R87"  "R88"  "R98"</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(cluster.result[[<span class="dv">2</span>]])</span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>cluster.result[[<span class="dv">3</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]</span></code></pre></div>
<pre><code>##  [1] ""       "l/"     "l/R100" "l/R101" "l/R122" "l/R124" "l/R125" "l/R146"
##  [9] "l/R149" "l/R151" "l/R152" "l/R155" "l/R156" "l/R157" "l/R158" "l/R166"
## [17] "l/R167" "l/R172" "l/R177" "l/R179"</code></pre>
</div>
<div id="get-the-community-membership" class="section level2">
<h2 class="hasAnchor">
<a href="#get-the-community-membership" class="anchor"></a>Get the community membership</h2>
<p>To get the community membership at each level, just use <code>community_membership</code> function and input the tree path from cluster results. You will directly get the dataframe of the community membership at each level. There is also an option for visualization to have an overlook of the hierarchical community structure.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>comm_member &lt;-<span class="st"> </span><span class="kw"><a href="../reference/community_membership.html">community_membership</a></span>(cluster.result<span class="op">$</span>tree.path,</span>
<span id="cb13-2"><a href="#cb13-2"></a>                                    <span class="dt">nlabels=</span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(cluster.result<span class="op">$</span>cluster.labels.list,length)))</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(comm_member)</span></code></pre></div>
<pre><code>##     id level node
## 1 R100     1  1-0
## 2 R101     1  1-0
## 3 R122     1  1-0
## 4 R124     1  1-0
## 5 R125     1  1-0
## 6 R146     1  1-0</code></pre>
<!-- <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script> -->
<!-- <script src="https://d3js.org/d3.v4.min.js"></script> -->
<!-- <div id = "viz"></div> -->
<p>To get the visualization</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>comm_member_wide &lt;-<span class="st"> </span>comm_member <span class="op">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="st">  </span><span class="kw">spread</span>(level,node,<span class="dt">sep=</span><span class="st">""</span>) <span class="op">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>id) <span class="op">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="st">  </span><span class="kw">distinct</span>(.)</span>
<span id="cb15-5"><a href="#cb15-5"></a>level.names &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(comm_member_wide)</span>
<span id="cb15-6"><a href="#cb15-6"></a></span>
<span id="cb15-7"><a href="#cb15-7"></a>data_for_tree &lt;-<span class="st"> </span>comm_member_wide <span class="op">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="op">!!!</span><span class="kw">syms</span>(level.names)) <span class="op">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="st">  </span><span class="kw">d3_nest</span>()</span>
<span id="cb15-10"><a href="#cb15-10"></a></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">#write file</span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co"># write(data_for_tree,file = paste("data_for_tree.json"))</span></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="kw">r2d3</span>(data_for_tree, <span class="dt">script =</span> <span class="st">"/home/siwei/bisbmHC/inst/binary_tree.js"</span>, </span>
<span id="cb15-14"><a href="#cb15-14"></a>     <span class="dt">container =</span> <span class="st">"div"</span>,<span class="dt">css =</span><span class="st">"/home/siwei/bisbmHC/inst/binary_tree.css"</span>,</span>
<span id="cb15-15"><a href="#cb15-15"></a>     <span class="dt">d3_version =</span> <span class="dv">5</span>)</span></code></pre></div>
<div id="htmlwidget-308dad1eed43ff0e28a4" style="width:700px;height:432.632880098888px;" class="r2d3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-308dad1eed43ff0e28a4">{"x":{"data":{"children":[{"name":"1-0","children":[],"colname":"level1"},{"name":"1-1","children":[{"name":"2-10","children":[{"name":"3-100","children":[],"colname":"level3"},{"name":"3-101","children":[{"name":"4-1010","children":[],"colname":"level4"},{"name":"4-1011","children":[],"colname":"level4"}],"colname":"level3"}],"colname":"level2"},{"name":"2-11","children":[{"name":"3-110","children":[],"colname":"level3"},{"name":"3-111","children":[{"name":"4-1110","children":[],"colname":"level4"},{"name":"4-1111","children":[{"name":"5-11110","children":[],"colname":"level5"},{"name":"5-11111","children":[{"name":"6-111110","colname":"level6"},{"name":"6-111111","colname":"level6"}],"colname":"level5"}],"colname":"level4"}],"colname":"level3"}],"colname":"level2"}],"colname":"level1"}],"name":"root"},"type":"json","container":"div","options":null,"script":"var d3Script = function(d3, r2d3, data, div, width, height, options, theme, console) {\nthis.d3 = d3;\n\ndiv = d3.select(div.node());\n/* R2D3 Source File:  /home/siwei/bisbmHC/inst/binary_tree.js */\n// !preview r2d3 data=data_for_tree, container=\"div\"\n//\n// r2d3: https://rstudio.github.io/r2d3\n//\n\n// set the dimensions and margins of the diagram\nvar margin = {top: 3390, right: 80, bottom: 50, left: 80},\n    width = 850 - margin.left - margin.right,\n    height = 3800 - margin.top - margin.bottom;\n\n\n// declares a tree layout and assigns the size\nvar treemap = d3.tree()\n    .size([width, height]);\n\n//  assigns the data to a hierarchy using parent-child relationships\nvar nodes = d3.hierarchy(data);\n\n// maps the node data to the tree layout\nnodes = treemap(nodes);\n\n// append the svg obgect to the body of the page\n// appends a 'group' element to 'svg'\n// moves the 'group' element to the top left margin\nvar svg = d3.select(\"body\").append(\"svg\")\n      .attr(\"width\", width + margin.left + margin.right)\n      .attr(\"height\", height + margin.top + margin.bottom),\n    g = svg.append(\"g\")\n      .attr(\"transform\",\n            \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n// adds the links between the nodes\nvar link = g.selectAll(\".link\")\n    .data( nodes.descendants().slice(1))\n  .enter().append(\"path\")\n    .attr(\"class\", \"link\")\n    .attr('fill', 'LightGray')\n    .attr(\"d\", function(d) {\n       return \"M\" + d.x + \",\" + d.y\n         + \"C\" + d.x + \",\" + (d.y + d.parent.y) / 2\n         + \" \" + d.parent.x + \",\" +  (d.y + d.parent.y) / 2\n         + \" \" + d.parent.x + \",\" + d.parent.y;\n       });\n\n// adds each node as a group\nvar node = g.selectAll(\".node\")\n    .data(nodes.descendants())\n  .enter().append(\"g\")\n    .attr(\"class\", function(d) { \n      return \"node\" + \n        (d.children ? \" node--internal\" : \" node--leaf\"); })\n    .attr(\"transform\", function(d) { \n      return \"translate(\" + d.x + \",\" + d.y + \")\"; });\n\n// adds the circle to the node\nnode.append(\"circle\")\n  .attr(\"r\", 10)\n  .attr('fill', 'DarkSeaGreen');\n\n// adds the text to the node\nnode.append(\"text\")\n  .attr(\"dy\", \".35em\")\n  .attr(\"y\", function(d) { return d.children ? -20 : 20; })\n  .style(\"text-anchor\", \"middle\")\n  .text(function(d) { return d.data.name; });\n};","style":"/* R2D3 Source File:  /home/siwei/bisbmHC/inst/binary_tree.css */\n.node circle {\n  fill: #8FBC8F;\n  stroke: DarkSeaGreen;\n  stroke-width: 3px;\n}\n\n.node text { font: 12px sans-serif; }\n\n.node--internal text {\n  text-shadow: 0 1px 0 #fff, 0 -1px 0 #fff, 1px 0 0 #fff, -1px 0 0 #fff;\n}\n\n.link {\n  fill: none;\n  stroke: #ccc;\n  stroke-width: 2px;\n}","version":5,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#set-up">Set up</a></li>
      <li><a href="#input-data">Input data</a></li>
      <li><a href="#run-bisbm-parallelly-in-docker">Run biSBM parallelly in Docker</a></li>
      <li><a href="#build-the-consensus-graph">Build the Consensus Graph</a></li>
      <li><a href="#recursive-partitioning">Recursive Partitioning</a></li>
      <li><a href="#get-the-community-membership">Get the community membership</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Siwei Zhang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
